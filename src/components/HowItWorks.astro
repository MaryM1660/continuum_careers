---
const steps = [
  {
    number: '01',
    title: 'Voice Discovery',
    description: 'Have a natural conversation with our AI. It asks the right questions to uncover your achievements, leadership moments, and technical decisions — things you wouldn\'t think to put on a resume.',
    visual: 'mic',
    color: 'magenta',
  },
  {
    number: '02',
    title: 'Strategic Planning',
    description: 'Get 4 career strategies: Ideal, Realistic, Compromise, and Anti-plan. Each with a clear positioning narrative, target roles, and companies matched to your profile.',
    visual: 'plan',
    color: 'amber',
  },
  {
    number: '03',
    title: 'Materials & Preparation',
    description: 'AI generates tailored resumes, gap assessments, and interview preparation for each track. Your Resume Studio keeps everything versioned and target-specific.',
    visual: 'doc',
    color: 'magenta',
  },
  {
    number: '04',
    title: 'Pipeline & Networking',
    description: 'Track your applications across 12 stages from discovery to offer. Get warm intro strategies and know exactly who to reach out to — and what to say.',
    visual: 'pipeline',
    color: 'amber',
  },
];
---

<section id="how-it-works" class="section-padding">
  <div class="container-narrow mx-auto">
    <!-- Section header -->
    <div class="text-center max-w-3xl mx-auto mb-20">
      <p data-animate class="text-sm font-semibold uppercase tracking-wider text-brand-amber mb-4">How It Works</p>
      <h2 data-animate class="text-3xl sm:text-4xl lg:text-5xl font-extrabold tracking-tight mb-6 stagger-1">
        From voice to offer in<br />
        <span class="gradient-text-reverse">four intelligent steps</span>
      </h2>
    </div>

    <!-- Steps -->
    <div class="relative">
      <!-- Connecting line -->
      <div class="hidden lg:block absolute left-1/2 top-0 bottom-0 w-px bg-gradient-to-b from-brand-magenta via-brand-amber to-brand-magenta opacity-20"></div>

      <div class="space-y-16 lg:space-y-24">
        {steps.map((step, i) => (
          <div
            data-animate
            class={`relative grid lg:grid-cols-2 gap-8 lg:gap-16 items-center ${i % 2 === 1 ? 'lg:direction-rtl' : ''}`}
          >
            <!-- Content -->
            <div class={`${i % 2 === 1 ? 'lg:order-2 lg:text-left' : ''}`}>
              <div class="flex items-center gap-4 mb-4">
                <span class={`text-5xl font-black ${step.color === 'magenta' ? 'text-brand-magenta/20 dark:text-brand-magenta/15' : 'text-brand-amber/20 dark:text-brand-amber/15'}`}>
                  {step.number}
                </span>
                <div class={`h-px flex-1 ${step.color === 'magenta' ? 'bg-brand-magenta/20' : 'bg-brand-amber/20'}`}></div>
              </div>
              <h3 class="text-2xl sm:text-3xl font-bold text-cosmos-900 dark:text-white mb-4">
                {step.title}
              </h3>
              <p class="text-lg text-cosmos-500 dark:text-cosmos-400 leading-relaxed">
                {step.description}
              </p>
            </div>

            <!-- Visual -->
            <div class={`${i % 2 === 1 ? 'lg:order-1' : ''}`}>
              <div class={`relative rounded-3xl overflow-hidden aspect-[4/3]
                bg-gradient-to-br
                ${step.color === 'magenta'
                  ? 'from-brand-magenta/5 to-brand-coral/5 dark:from-brand-magenta/10 dark:to-brand-coral/10 border border-brand-magenta/10'
                  : 'from-brand-amber/5 to-brand-amber/5 dark:from-brand-amber/10 dark:to-brand-amber/10 border border-brand-amber/10'}
                flex items-center justify-center`}
              >
                {step.visual === 'mic' && (
                  <div class="text-center">
                    <div class={`w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-4 ${step.color === 'magenta' ? 'bg-brand-magenta/15' : 'bg-brand-amber/15'}`}>
                      <svg class={`w-10 h-10 ${step.color === 'magenta' ? 'text-brand-magenta' : 'text-brand-amber'}`} fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z" />
                      </svg>
                    </div>
                    <div class="flex justify-center gap-1">
                      {Array.from({length: 12}).map((_, j) => (
                        <div class="w-1 bg-brand-magenta/60 rounded-full voice-bar-sm" style={`animation-delay: ${j * 0.08}s;`}></div>
                      ))}
                    </div>
                    <p class="text-sm text-cosmos-500 dark:text-cosmos-400 mt-4">"Tell me about your biggest technical decision..."</p>
                  </div>
                )}
                {step.visual === 'plan' && (
                  <div class="p-6 w-full max-w-sm mx-auto">
                    <div class="grid grid-cols-2 gap-3 mb-4">
                      {[
                        { name: 'Ideal Plan', icon: '★', desc: 'Dream roles at top companies', color: 'magenta' },
                        { name: 'Realistic Plan', icon: '◆', desc: 'High-probability matches', color: 'amber' },
                        { name: 'Compromise', icon: '◐', desc: 'Trade-offs you can live with', color: 'gray' },
                        { name: 'Anti-Plan', icon: '✕', desc: 'Paths to explicitly avoid', color: 'red' },
                      ].map((plan, j) => (
                        <div class={`rounded-xl p-4 text-left transition-all duration-300 hover:scale-[1.02]
                          ${plan.color === 'magenta' ? 'bg-brand-magenta/10 border border-brand-magenta/20' :
                            plan.color === 'amber' ? 'bg-brand-amber/10 border border-brand-amber/20' :
                            plan.color === 'red' ? 'bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800/30' :
                            'bg-cosmos-100/50 dark:bg-cosmos-700/30 border border-cosmos-200 dark:border-cosmos-700'}`}
                        >
                          <div class="flex items-center gap-2 mb-2">
                            <span class={`text-lg
                              ${plan.color === 'magenta' ? 'text-brand-magenta' :
                                plan.color === 'amber' ? 'text-brand-amber' :
                                plan.color === 'red' ? 'text-red-400' :
                                'text-cosmos-400'}`}>{plan.icon}</span>
                            <span class={`text-xs font-bold
                              ${plan.color === 'magenta' ? 'text-brand-magenta' :
                                plan.color === 'amber' ? 'text-brand-amber' :
                                plan.color === 'red' ? 'text-red-500' :
                                'text-cosmos-500 dark:text-cosmos-400'}`}>{plan.name}</span>
                          </div>
                          <p class="text-[10px] text-cosmos-500 dark:text-cosmos-400 leading-snug">{plan.desc}</p>
                        </div>
                      ))}
                    </div>
                    <div class="flex items-center gap-2 px-2">
                      <div class="w-2 h-2 rounded-full bg-brand-magenta animate-pulse"></div>
                      <p class="text-[11px] text-cosmos-500 dark:text-cosmos-400 italic">AI analyzes your profile and generates all 4 strategies</p>
                    </div>
                  </div>
                )}
                {step.visual === 'doc' && (
                  <div class="p-5 w-full max-w-sm mx-auto space-y-3">
                    <!-- Resume card -->
                    <div class="bg-white dark:bg-cosmos-800 rounded-xl shadow-lg p-5">
                      <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center gap-2">
                          <div class="w-8 h-8 rounded-lg bg-brand-magenta/10 flex items-center justify-center">
                            <svg class="w-4 h-4 text-brand-magenta" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" /></svg>
                          </div>
                          <div>
                            <p class="text-xs font-bold text-cosmos-800 dark:text-cosmos-200">Resume — Leadership Track</p>
                            <p class="text-[10px] text-cosmos-400">v3.2 · Updated 2h ago</p>
                          </div>
                        </div>
                        <span class="px-2 py-0.5 rounded text-[9px] font-bold bg-brand-magenta/10 text-brand-magenta uppercase">Active</span>
                      </div>
                      <div class="space-y-2">
                        <div class="h-2 bg-cosmos-100 dark:bg-cosmos-700/50 rounded w-full"></div>
                        <div class="h-2 bg-cosmos-100 dark:bg-cosmos-700/50 rounded w-5/6"></div>
                        <div class="h-2 bg-cosmos-100 dark:bg-cosmos-700/50 rounded w-4/6"></div>
                      </div>
                      <div class="mt-3 flex gap-2">
                        <span class="px-2 py-0.5 rounded text-[9px] font-medium bg-brand-magenta/10 text-brand-magenta">Leadership</span>
                        <span class="px-2 py-0.5 rounded text-[9px] font-medium bg-brand-amber/10 text-brand-amber">Strategy</span>
                        <span class="px-2 py-0.5 rounded text-[9px] font-medium bg-brand-coral/10 text-brand-coral">6 cases</span>
                      </div>
                    </div>
                    <!-- Gap assessment mini-card -->
                    <div class="bg-white dark:bg-cosmos-800 rounded-xl shadow-lg p-4 flex items-center gap-3">
                      <div class="w-10 h-10 rounded-lg bg-brand-amber/10 flex items-center justify-center flex-shrink-0">
                        <svg class="w-5 h-5 text-brand-amber" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                      </div>
                      <div class="flex-1">
                        <p class="text-xs font-bold text-cosmos-800 dark:text-cosmos-200">Gap Assessment</p>
                        <div class="mt-1 w-full h-1.5 bg-cosmos-100 dark:bg-cosmos-700 rounded-full overflow-hidden">
                          <div class="h-full bg-gradient-to-r from-brand-magenta to-brand-amber rounded-full" style="width: 72%;"></div>
                        </div>
                        <p class="text-[10px] text-cosmos-400 mt-0.5">72% ready · 3 gaps identified</p>
                      </div>
                    </div>
                  </div>
                )}
                {step.visual === 'pipeline' && (
                  <div class="p-5 w-full max-w-sm mx-auto">
                    <!-- Pipeline header -->
                    <div class="flex items-center justify-between mb-4">
                      <div class="flex items-center gap-2">
                        <div class="w-8 h-8 rounded-lg bg-brand-amber/10 flex items-center justify-center">
                          <svg class="w-4 h-4 text-brand-amber" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" /></svg>
                        </div>
                        <p class="text-xs font-bold text-cosmos-800 dark:text-cosmos-200">My Pipeline</p>
                      </div>
                      <span class="text-[10px] text-cosmos-400">7 active opportunities</span>
                    </div>
                    <!-- Pipeline stages -->
                    <div class="flex items-end gap-1 mb-3 h-16">
                      {[
                        { h: '100%', count: 3, color: 'brand-magenta' },
                        { h: '70%', count: 2, color: 'brand-coral' },
                        { h: '50%', count: 1, color: 'brand-amber' },
                        { h: '30%', count: 1, color: 'brand-amber' },
                        { h: '15%', count: 0, color: 'cosmos-300 dark:bg-cosmos-600' },
                      ].map((bar) => (
                        <div class="flex-1 flex flex-col items-center gap-1">
                          <span class="text-[10px] font-bold text-cosmos-600 dark:text-cosmos-300">{bar.count || ''}</span>
                          <div class={`w-full rounded-t-md bg-${bar.color}`} style={`height: ${bar.h};`}></div>
                        </div>
                      ))}
                    </div>
                    <div class="flex gap-1 text-[9px] text-cosmos-400">
                      {['Discovery', 'Applied', 'Screen', 'Interview', 'Offer'].map((s) => (
                        <span class="flex-1 text-center">{s}</span>
                      ))}
                    </div>
                    <!-- Sample opportunity cards -->
                    <div class="mt-4 space-y-2">
                      {[
                        { company: 'TechCorp', role: 'Head of Product', stage: 'Interview', color: 'amber' },
                        { company: 'FinanceAI', role: 'VP Engineering', stage: 'Screen', color: 'coral' },
                      ].map((opp) => (
                        <div class="flex items-center gap-3 bg-white dark:bg-cosmos-800 rounded-lg p-2.5 shadow-sm border border-cosmos-100 dark:border-cosmos-700">
                          <div class={`w-8 h-8 rounded-lg bg-brand-${opp.color}/10 flex items-center justify-center text-[10px] font-bold text-brand-${opp.color}`}>
                            {opp.company.slice(0, 2)}
                          </div>
                          <div class="flex-1 min-w-0">
                            <p class="text-[11px] font-semibold text-cosmos-800 dark:text-cosmos-200 truncate">{opp.role}</p>
                            <p class="text-[10px] text-cosmos-400">{opp.company} · {opp.stage}</p>
                          </div>
                          <svg class="w-4 h-4 text-cosmos-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" /></svg>
                        </div>
                      ))}
                    </div>
                  </div>
                )}
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>

<style>
  .voice-bar-sm {
    height: 6px;
    animation: voice-wave-sm 1s ease-in-out infinite;
  }

  @keyframes voice-wave-sm {
    0%, 100% { height: 6px; }
    50% { height: 32px; }
  }
</style>
